<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Language" content="th">
    <meta http-equiv="Content-Type" content="text/html; charset=windows-874">
    <title>VerbalExpressions example</title>

    <script src='http://161.246.5.237/web/jsregex/jquery-1.10.2.js' type='text/javascript'></script>


    <script>
    function getTB(){
        //thai day formation
        function thDay(d){
            console.log("DATE:"+d+"�");
            if(d=="จ"){
                console.log(1);
                return 1;
            }
            else if(d=="อ"){
                return 2;
            }
            else if(d=="พ"){
                return 3;
            }
            else if(d=="พฤ"){
                return 4;
            }
            else if(d=="ศ"){
                return 5;
            }
            else if(d=="ส"){
                return 6;
            }
            else{
                return 7;
            }
        }

        //sorting day function
        function compare(a,b) {
            patt1 = /[0-9]/gi;
            atxt=a.studytime.innerHTML;
            patt1.test(atxt);
            na=patt1.lastIndex;
            atime=atxt.substring(na-1,na+1);

            patt2 = /[0-9]/gi;
            btxt=b.studytime.innerHTML;
            patt2.test(btxt);
            nb=patt2.lastIndex;
            btime=btxt.substring(nb-1,nb+1);

            aday=atxt.substring(0,na-3);//.trim();
            bday=btxt.substring(0,nb-3);//.trim();

           /* if (thDay(aday) < thDay(bday))
                return -1;
            if (thDay(aday) > thDay(bday))
                return 1;
            return 0;*/

            if ((aday) < (bday))
                return -1;
            if ((aday) > (bday))
                return 1;
            return 0;
        }


        //sorting time in day function
        function compareTime(a,b) {
            patt1 = /[0-9]/gi;
            atxt=a.studytime.innerHTML;
            patt1.test(atxt);
            na=patt1.lastIndex;
            atime=atxt.substring(na-1,na+1);

            patt2 = /[0-9]/gi;
            btxt=b.studytime.innerHTML;
            patt2.test(btxt);
            nb=patt2.lastIndex;
            btime=btxt.substring(nb-1,nb+1);

            aday=atxt.substring(0,na-3);//.trim();
            bday=btxt.substring(0,nb-3);//.trim();

           if (thDay(aday) < thDay(bday))
                return -1;
            if (thDay(aday) > thDay(bday))
                return 1;
            return 0;
        }





        // get table
        var subject_row = new Array();
        var subject_all    = new Array();
        var subject    = new Object();
        var number=9;

        //-----------
        mybody      = document.getElementsByTagName("body")[0];
        mytable     = mybody.getElementsByTagName("table")[0];
        mytablebody = mytable.getElementsByTagName("tbody")[0];

        for (var i=0;i<20;i++)
        { 
            subject_row[i]  = mytablebody.getElementsByTagName("tr")[19+(i*2)];
            //console.log(subject_row[i]);
            if (!subject_row[i])
            {
                number=i;
                break;
            }
            subject = new Object();
            subject.no = subject_row[i].getElementsByTagName("td")[0];
            if (subject.no.innerHTML=="")
            {
                number=i;
                break;
            }
            subject.sid = subject_row[i].getElementsByTagName("td")[2];
            subject.sname = subject_row[i].getElementsByTagName("td")[4];//alert(subject_name[i].innerHTML);
            subject.w = subject_row[i].getElementsByTagName("td")[6];
            subject.section = subject_row[i].getElementsByTagName("td")[8];
            subject.studytime = subject_row[i].getElementsByTagName("td")[10];
            subject.room = subject_row[i].getElementsByTagName("td")[12];
            subject.build = subject_row[i].getElementsByTagName("td")[14];
            subject_all[i]=subject;
        }
        
        $("body").empty();

        subject_all.sort(compare);




        subject_1    = new Array();
        subject_2    = new Array();
        subject_3    = new Array();
        subject_4    = new Array();
        subject_5    = new Array();
        subject_6    = new Array();
        subject_7    = new Array();
        lastDay="0";
        noOfDayInWeek=1;

        // divide subject into day
        for (var i=0;i<number;i++)
        { 
            studytime = subject_all[i].studytime.innerHTML;
            if(lastDay=="0"){
                lastDay=studytime.substring(0,studytime.indexOf("."));
            }
            else if(lastDay!=studytime.substring(0,studytime.indexOf("."))){
                noOfDayInWeek++;
                lastDay=studytime.substring(0,studytime.indexOf("."));
            }
            if(lastDay==studytime.substring(0,studytime.indexOf("."))){
                switch(noOfDayInWeek)
                {
                    case 1:
                        subject_1.push(subject_all[i]);
                        break;
                    case 2:
                        subject_2.push(subject_all[i]);
                        break;
                    case 3:
                        subject_3.push(subject_all[i]);
                        break;
                    case 4:
                        subject_4.push(subject_all[i]);
                        break;
                    case 5:
                        subject_5.push(subject_all[i]);
                        break;
                    case 6:
                        subject_6.push(subject_all[i]);
                        break;
                    default://7
                      subject_7.push(subject_all[i]);
                }

            }
        }

        // print
        for (var i=0;i<number;i++)
        { 
            studytime = subject_all[i].studytime.innerHTML;
            if(lastDay=="0"){
                lastDay=studytime.substring(0,studytime.indexOf("."));
                $("body").append("<br/>");
                $("body").append(studytime.substring(0,studytime.indexOf(".")+1));
            }
            else if(lastDay!=studytime.substring(0,studytime.indexOf("."))){
                lastDay=studytime.substring(0,studytime.indexOf("."));
                $("body").append("<br/>");
                $("body").append("<br/>");
                $("body").append(studytime.substring(0,studytime.indexOf(".")+1));
            }
            if(lastDay==studytime.substring(0,studytime.indexOf("."))){
                //display a subject detail
                $("body").append("<br/>");
                $("body").append(studytime.substring(studytime.indexOf(".")+1,studytime.indexOf(".")+14));
                $("body").append(subject_all[i].sname.innerHTML);                
                $("body").append("( SEC: "+subject_all[i].section.innerHTML+")");
            }
        }
    }
    </script>

</head>
<body>
    <ul id="results">VerbalExpressions</ul>
    <script>
        $.get('http://161.246.5.237/web/jsregex/ce.html',function(data){
            document.write(data);            
            //alert("fck");
            window.setTimeout(getTB,50);
            //getTB();
        });

    </script>

</body>
</html>
